# UnoDay è¯­éŸ³å¯¹è¯æŠ€æœ¯æ–¹æ¡ˆ

## æ¦‚è¿°

UnoDay å°†é‡‡ç”¨**è¯­éŸ³ä¼˜å…ˆ**çš„ AI äº¤äº’æ–¹å¼ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è¯­éŸ³è¾“å…¥å’Œè¾“å‡ºä¸ AI åŠ©æ‰‹å¯¹è¯ï¼Œå®ç°æ›´è‡ªç„¶ã€å…æ‰“å­—çš„ä¸“æ³¨ä½“éªŒã€‚

---

## 1. æŠ€æœ¯é€‰å‹è¯„ä¼°

### 1.1 è¯­éŸ³è¾“å…¥ï¼ˆSTT - Speech-to-Textï¼‰

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æˆæœ¬ | æ¨èåº¦ |
|------|------|------|------|--------|
| **OpenAI Whisper API** | â€¢ é«˜å‡†ç¡®åº¦<br>â€¢ æ”¯æŒä¸­è‹±æ–‡<br>â€¢ è‡ªåŠ¨æ ‡ç‚¹<br>â€¢ ä¸ç°æœ‰ OpenAI é›†æˆæ–¹ä¾¿ | â€¢ éœ€è¦ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶<br>â€¢ æœ‰ç½‘ç»œå»¶è¿Ÿ | $0.006/åˆ†é’Ÿ | â­â­â­â­â­ |
| **Web Speech API** | â€¢ æµè§ˆå™¨åŸç”Ÿ<br>â€¢ å…è´¹<br>â€¢ å®æ—¶æµå¼è¯†åˆ« | â€¢ æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜<br>â€¢ å‡†ç¡®åº¦ä¸€èˆ¬<br>â€¢ ä¸­æ–‡æ”¯æŒä¸ç¨³å®š | å…è´¹ | â­â­â­ |
| **Google Cloud STT** | â€¢ å‡†ç¡®åº¦é«˜<br>â€¢ ä¼ä¸šçº§ç¨³å®šæ€§ | â€¢ é…ç½®å¤æ‚<br>â€¢ æˆæœ¬è¾ƒé«˜ | $0.016/åˆ†é’Ÿ | â­â­â­ |
| **Azure Speech** | â€¢ å‡†ç¡®åº¦é«˜<br>â€¢ å®æ—¶æµå¼ | â€¢ é…ç½®å¤æ‚<br>â€¢ æˆæœ¬è¾ƒé«˜ | $1/å°æ—¶ | â­â­â­ |

**æ¨èæ–¹æ¡ˆ**: OpenAI Whisper APIï¼ˆä¸»è¦ï¼‰+ Web Speech APIï¼ˆå¤‡é€‰ï¼‰

**ç†ç”±**:
- Whisper å‡†ç¡®åº¦æœ€é«˜ï¼Œç‰¹åˆ«æ˜¯ä¸­æ–‡åœºæ™¯
- ä¸ç°æœ‰ OpenAI embedding é›†æˆæ–¹ä¾¿ï¼Œç»Ÿä¸€ API Key
- æˆæœ¬å¯æ§ï¼ˆ$0.006/åˆ†é’Ÿ = æ¯å°æ—¶ $0.36ï¼‰
- Web Speech API ä½œä¸ºé™çº§æ–¹æ¡ˆï¼Œæå‡ç”¨æˆ·ä½“éªŒ

### 1.2 è¯­éŸ³è¾“å‡ºï¼ˆTTS - Text-to-Speechï¼‰

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æˆæœ¬ | æ¨èåº¦ |
|------|------|------|------|--------|
| **OpenAI TTS API** | â€¢ å£°éŸ³è‡ªç„¶<br>â€¢ 6 ç§å£°éŸ³é€‰æ‹©<br>â€¢ æ”¯æŒä¸­è‹±æ–‡<br>â€¢ é›†æˆç®€å• | â€¢ éœ€è¦æµå¼å¤„ç†<br>â€¢ å»¶è¿Ÿç¨é«˜ | $15/1M å­—ç¬¦ | â­â­â­â­â­ |
| **Web Speech API** | â€¢ æµè§ˆå™¨åŸç”Ÿ<br>â€¢ å…è´¹<br>â€¢ é›¶å»¶è¿Ÿ | â€¢ å£°éŸ³æœºæ¢°<br>â€¢ æµè§ˆå™¨å…¼å®¹æ€§ | å…è´¹ | â­â­â­ |
| **ElevenLabs** | â€¢ æœ€è‡ªç„¶çš„å£°éŸ³<br>â€¢ æƒ…æ„Ÿè¡¨è¾¾ä¸°å¯Œ | â€¢ æˆæœ¬é«˜<br>â€¢ é¢å¤– API é›†æˆ | $0.30/1K å­—ç¬¦ | â­â­â­ |
| **Azure Neural TTS** | â€¢ å£°éŸ³è‡ªç„¶<br>â€¢ ä¼ä¸šçº§ | â€¢ é…ç½®å¤æ‚<br>â€¢ æˆæœ¬è¾ƒé«˜ | $16/1M å­—ç¬¦ | â­â­â­ |

**æ¨èæ–¹æ¡ˆ**: OpenAI TTS APIï¼ˆä¸»è¦ï¼‰+ Web Speech APIï¼ˆå¤‡é€‰ï¼‰

**ç†ç”±**:
- OpenAI TTS å£°éŸ³è‡ªç„¶åº¦é«˜ï¼Œé€‚åˆä¸­æ–‡
- ä¸ç°æœ‰æŠ€æœ¯æ ˆç»Ÿä¸€
- æˆæœ¬åˆç†ï¼ˆå¹³å‡æ¯æ¡å›å¤ 50 å­— = $0.00075ï¼‰
- Web Speech API ä½œä¸ºé™çº§æ–¹æ¡ˆ

---

## 2. ç³»ç»Ÿæ¶æ„è®¾è®¡

### 2.1 è¯­éŸ³äº¤äº’æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         User Interface                       â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚         Voice Chat Interface (è¯­éŸ³èŠå¤©ç•Œé¢)            â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  [ğŸ¤ æŒ‰ä½è¯´è¯] â†â†’ [æ³¢å½¢åŠ¨ç”»] â†â†’ [ğŸ”Š æ’­æ”¾å›å¤]         â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  [å¯¹è¯å†å²ï¼ˆæ–‡å­—è®°å½•ï¼‰]                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â†“ â†‘                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Frontend Audio Processing                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  MediaRecorder API (å½•éŸ³)                            â”‚   â”‚
â”‚  â”‚  â€¢ æ•è·éº¦å…‹é£éŸ³é¢‘æµ                                   â”‚   â”‚
â”‚  â”‚  â€¢ å®æ—¶æ³¢å½¢å¯è§†åŒ–                                     â”‚   â”‚
â”‚  â”‚  â€¢ ç”Ÿæˆ WebM/MP3 éŸ³é¢‘ Blob                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Web Audio API (æ’­æ”¾)                                â”‚   â”‚
â”‚  â”‚  â€¢ è§£ç éŸ³é¢‘æµ                                         â”‚   â”‚
â”‚  â”‚  â€¢ æ§åˆ¶æ’­æ”¾/æš‚åœ                                      â”‚   â”‚
â”‚  â”‚  â€¢ éŸ³é‡æ§åˆ¶                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API Routes (Next.js)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /api/voice/transcribe (STT)                         â”‚   â”‚
â”‚  â”‚  â€¢ æ¥æ”¶éŸ³é¢‘æ–‡ä»¶                                       â”‚   â”‚
â”‚  â”‚  â€¢ è°ƒç”¨ Whisper API                                  â”‚   â”‚
â”‚  â”‚  â€¢ è¿”å›æ–‡å­—è½¬å½•                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /api/voice/chat (AI Chat)                           â”‚   â”‚
â”‚  â”‚  â€¢ æ¥æ”¶æ–‡å­—æ¶ˆæ¯                                       â”‚   â”‚
â”‚  â”‚  â€¢ è°ƒç”¨ Anthropic API                                â”‚   â”‚
â”‚  â”‚  â€¢ æ‰§è¡Œå·¥å…·è°ƒç”¨                                       â”‚   â”‚
â”‚  â”‚  â€¢ è¿”å› AI å›å¤æ–‡å­—                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /api/voice/synthesize (TTS)                         â”‚   â”‚
â”‚  â”‚  â€¢ æ¥æ”¶æ–‡å­—                                           â”‚   â”‚
â”‚  â”‚  â€¢ è°ƒç”¨ OpenAI TTS API                               â”‚   â”‚
â”‚  â”‚  â€¢ æµå¼è¿”å›éŸ³é¢‘æ•°æ®                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     External AI Services                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ OpenAI Whisper  â”‚  â”‚ Anthropic    â”‚  â”‚ OpenAI TTS     â”‚  â”‚
â”‚  â”‚ (STT)           â”‚  â”‚ Claude 3.5   â”‚  â”‚ (TTS)          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å®Œæ•´å¯¹è¯æµç¨‹

```
ç”¨æˆ·æŒ‰ä¸‹"æŒ‰ä½è¯´è¯"æŒ‰é’®
  â†“
å¼€å§‹å½•éŸ³ï¼ˆMediaRecorderï¼‰
æ˜¾ç¤ºæ³¢å½¢åŠ¨ç”»
  â†“
ç”¨æˆ·æ¾å¼€æŒ‰é’®
  â†“
åœæ­¢å½•éŸ³ï¼Œç”ŸæˆéŸ³é¢‘ Blob
  â†“
ä¸Šä¼ åˆ° /api/voice/transcribe
  â†“
Whisper API è½¬å½• â†’ æ–‡å­—
  â†“
æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯ï¼ˆæ–‡å­—ï¼‰
  â†“
å‘é€æ–‡å­—åˆ° /api/voice/chat
  â†“
Claude 3.5 å¤„ç† + å·¥å…·è°ƒç”¨
  â†“
è¿”å› AI å›å¤æ–‡å­—
  â†“
æ˜¾ç¤º AI æ¶ˆæ¯ï¼ˆæ–‡å­—ï¼‰
  â†“
å‘é€æ–‡å­—åˆ° /api/voice/synthesize
  â†“
OpenAI TTS ç”ŸæˆéŸ³é¢‘æµ
  â†“
æ’­æ”¾éŸ³é¢‘ï¼ˆWeb Audio APIï¼‰
æ˜¾ç¤ºæ’­æ”¾åŠ¨ç”»
```

---

## 3. UI/UX è®¾è®¡

### 3.1 è¯­éŸ³èŠå¤©ç•Œé¢è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”™  AI è¯­éŸ³åŠ©æ‰‹              ğŸ”‡  âš™ï¸    â”‚  â† å¤´éƒ¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ‘¤ ä½ è¯´: "æˆ‘æƒ³åˆ°è¦ä¹°èœ"            â”‚ â”‚  â† ç”¨æˆ·æ¶ˆæ¯
â”‚  â”‚    ğŸ• 14:23                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ¤– AI: "å¥½çš„ï¼Œæˆ‘å¸®ä½ è®°å½•åˆ°æ‚å¿µç®±" â”‚ â”‚  â† AI æ¶ˆæ¯
â”‚  â”‚    [âš¡ åˆ›å»ºæ‚å¿µ]                   â”‚ â”‚  â† å·¥å…·è°ƒç”¨æ ‡è®°
â”‚  â”‚    ğŸ• 14:23  â–¶ï¸ æ’­æ”¾è¯­éŸ³           â”‚ â”‚  â† æ’­æ”¾æŒ‰é’®
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ‘¤ ä½ è¯´: "æˆ‘è¦ä¸“æ³¨å­¦ä¹  React"     â”‚ â”‚
â”‚  â”‚    ğŸ• 14:24                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ¤– AI: "å¼€å§‹ä¸“æ³¨å­¦ä¹  Reactï¼"     â”‚ â”‚
â”‚  â”‚    [âš¡ å¼€å§‹ä¸“æ³¨]                   â”‚ â”‚
â”‚  â”‚    ğŸ• 14:24  â–¶ï¸ æ’­æ”¾è¯­éŸ³           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚  â† å½•éŸ³åŒºåŸŸ
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚        â”‚                     â”‚          â”‚
â”‚        â”‚    ğŸ¤ æŒ‰ä½è¯´è¯       â”‚          â”‚  â† å½•éŸ³æŒ‰é’®ï¼ˆå¤§æŒ‰é’®ï¼‰
â”‚        â”‚                     â”‚          â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                          â”‚
â”‚      [æ³¢å½¢åŠ¨ç”»åœ¨å½•éŸ³æ—¶æ˜¾ç¤º]              â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 äº¤äº’çŠ¶æ€è®¾è®¡

| çŠ¶æ€ | è§†è§‰æ•ˆæœ | æè¿° |
|------|---------|------|
| **å¾…æœº** | é™æ€éº¦å…‹é£å›¾æ ‡ | ç”¨æˆ·å¯ä»¥æŒ‰ä¸‹å¼€å§‹å½•éŸ³ |
| **å½•éŸ³ä¸­** | è„‰åŠ¨çº¢ç‚¹ + æ³¢å½¢åŠ¨ç”» | å®æ—¶æ˜¾ç¤ºéŸ³é¢‘æ³¢å½¢ |
| **è¯†åˆ«ä¸­** | Loading åŠ¨ç”» | Whisper æ­£åœ¨è½¬å½• |
| **æ€è€ƒä¸­** | AI å›¾æ ‡æ—‹è½¬ | Claude æ­£åœ¨ç”Ÿæˆå›å¤ |
| **æ’­æ”¾ä¸­** | å£°æ³¢åŠ¨ç”» + è¿›åº¦æ¡ | TTS éŸ³é¢‘æ’­æ”¾ä¸­ |
| **é”™è¯¯** | é”™è¯¯æç¤º + é‡è¯•æŒ‰é’® | ç½‘ç»œæˆ–æœåŠ¡é”™è¯¯ |

### 3.3 æŒ‰é’®äº¤äº’è®¾è®¡

**æ–¹æ¡ˆ 1: æŒ‰ä½è¯´è¯ï¼ˆPush-to-Talkï¼‰** â­â­â­â­â­
```
ç”¨æˆ·é•¿æŒ‰æŒ‰é’® â†’ å¼€å§‹å½•éŸ³
ç”¨æˆ·æ¾å¼€æŒ‰é’® â†’ åœæ­¢å½•éŸ³å¹¶å‘é€
```
- âœ… ç¬¦åˆå¯¹è®²æœºç›´è§‰
- âœ… ä¸ä¼šè¯¯è§¦
- âœ… é€‚åˆå¿«é€Ÿå¯¹è¯

**æ–¹æ¡ˆ 2: ç‚¹å‡»åˆ‡æ¢ï¼ˆTap-to-Toggleï¼‰** â­â­â­
```
ç‚¹å‡»ä¸€æ¬¡ â†’ å¼€å§‹å½•éŸ³
å†ç‚¹å‡»ä¸€æ¬¡ â†’ åœæ­¢å½•éŸ³
```
- âŒ å¯èƒ½å¿˜è®°å…³é—­
- âœ… é€‚åˆé•¿æ®µè¯­éŸ³

**æ¨è**: æ–¹æ¡ˆ 1ï¼ˆæŒ‰ä½è¯´è¯ï¼‰ï¼Œå¹¶æ”¯æŒè‡ªåŠ¨åœé¡¿æ£€æµ‹ï¼ˆ3 ç§’æ— å£°è‡ªåŠ¨åœæ­¢ï¼‰

---

## 4. æŠ€æœ¯å®ç°ç»†èŠ‚

### 4.1 å‰ç«¯å½•éŸ³å®ç°

```typescript
// hooks/useVoiceRecorder.ts
import { useState, useRef, useCallback } from 'react'

export function useVoiceRecorder() {
  const [isRecording, setIsRecording] = useState(false)
  const [audioLevel, setAudioLevel] = useState(0) // 0-100
  const mediaRecorderRef = useRef<MediaRecorder | null>(null)
  const audioChunksRef = useRef<Blob[]>([])
  const analyserRef = useRef<AnalyserNode | null>(null)

  const startRecording = useCallback(async () => {
    try {
      // è¯·æ±‚éº¦å…‹é£æƒé™
      const stream = await navigator.mediaDevices.getUserMedia({
        audio: {
          echoCancellation: true,
          noiseSuppression: true,
          autoGainControl: true,
        },
      })

      // åˆ›å»º MediaRecorder
      const mediaRecorder = new MediaRecorder(stream, {
        mimeType: 'audio/webm',
      })

      // åˆ›å»ºéŸ³é¢‘åˆ†æå™¨ï¼ˆç”¨äºæ³¢å½¢å¯è§†åŒ–ï¼‰
      const audioContext = new AudioContext()
      const source = audioContext.createMediaStreamSource(stream)
      const analyser = audioContext.createAnalyser()
      analyser.fftSize = 256
      source.connect(analyser)
      analyserRef.current = analyser

      // å®æ—¶æ›´æ–°éŸ³é‡
      const dataArray = new Uint8Array(analyser.frequencyBinCount)
      const updateLevel = () => {
        if (!isRecording) return
        analyser.getByteFrequencyData(dataArray)
        const average = dataArray.reduce((a, b) => a + b) / dataArray.length
        setAudioLevel(Math.min(100, (average / 255) * 100))
        requestAnimationFrame(updateLevel)
      }
      updateLevel()

      // æ”¶é›†éŸ³é¢‘æ•°æ®
      audioChunksRef.current = []
      mediaRecorder.ondataavailable = (event) => {
        if (event.data.size > 0) {
          audioChunksRef.current.push(event.data)
        }
      }

      mediaRecorder.start()
      mediaRecorderRef.current = mediaRecorder
      setIsRecording(true)
    } catch (error) {
      console.error('å½•éŸ³å¤±è´¥:', error)
      throw error
    }
  }, [])

  const stopRecording = useCallback((): Promise<Blob> => {
    return new Promise((resolve, reject) => {
      const mediaRecorder = mediaRecorderRef.current
      if (!mediaRecorder) {
        reject(new Error('æœªå¼€å§‹å½•éŸ³'))
        return
      }

      mediaRecorder.onstop = () => {
        const audioBlob = new Blob(audioChunksRef.current, {
          type: 'audio/webm',
        })

        // åœæ­¢æ‰€æœ‰è½¨é“
        mediaRecorder.stream.getTracks().forEach((track) => track.stop())

        setIsRecording(false)
        setAudioLevel(0)
        resolve(audioBlob)
      }

      mediaRecorder.stop()
    })
  }, [])

  return {
    isRecording,
    audioLevel,
    startRecording,
    stopRecording,
  }
}
```

### 4.2 STT API å®ç°

```typescript
// app/api/voice/transcribe/route.ts
import { OpenAI } from 'openai'
import { NextResponse } from 'next/server'

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
})

export async function POST(req: Request) {
  try {
    const formData = await req.formData()
    const audioFile = formData.get('audio') as File

    if (!audioFile) {
      return NextResponse.json(
        { error: 'ç¼ºå°‘éŸ³é¢‘æ–‡ä»¶' },
        { status: 400 }
      )
    }

    // è°ƒç”¨ Whisper API
    const transcription = await openai.audio.transcriptions.create({
      file: audioFile,
      model: 'whisper-1',
      language: 'zh', // æŒ‡å®šä¸­æ–‡ï¼Œæé«˜å‡†ç¡®åº¦
      response_format: 'verbose_json', // è·å–æ›´å¤šä¿¡æ¯
    })

    return NextResponse.json({
      success: true,
      text: transcription.text,
      duration: transcription.duration,
      language: transcription.language,
    })
  } catch (error: any) {
    console.error('è½¬å½•å¤±è´¥:', error)
    return NextResponse.json(
      { error: error.message || 'è½¬å½•å¤±è´¥' },
      { status: 500 }
    )
  }
}
```

### 4.3 TTS API å®ç°

```typescript
// app/api/voice/synthesize/route.ts
import { OpenAI } from 'openai'
import { NextResponse } from 'next/server'

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
})

export async function POST(req: Request) {
  try {
    const { text, voice = 'nova' } = await req.json()

    if (!text) {
      return NextResponse.json(
        { error: 'ç¼ºå°‘æ–‡æœ¬å†…å®¹' },
        { status: 400 }
      )
    }

    // è°ƒç”¨ TTS API
    const mp3 = await openai.audio.speech.create({
      model: 'tts-1', // æˆ– 'tts-1-hd' æ›´é«˜è´¨é‡
      voice: voice, // 'alloy', 'echo', 'fable', 'onyx', 'nova', 'shimmer'
      input: text,
      speed: 1.0, // è¯­é€Ÿ 0.25-4.0
    })

    // è¿”å›éŸ³é¢‘æµ
    const buffer = Buffer.from(await mp3.arrayBuffer())

    return new NextResponse(buffer, {
      headers: {
        'Content-Type': 'audio/mpeg',
        'Content-Length': buffer.length.toString(),
      },
    })
  } catch (error: any) {
    console.error('è¯­éŸ³åˆæˆå¤±è´¥:', error)
    return NextResponse.json(
      { error: error.message || 'è¯­éŸ³åˆæˆå¤±è´¥' },
      { status: 500 }
    )
  }
}
```

### 4.4 éŸ³é¢‘æ’­æ”¾å®ç°

```typescript
// hooks/useAudioPlayer.ts
import { useState, useRef, useCallback } from 'react'

export function useAudioPlayer() {
  const [isPlaying, setIsPlaying] = useState(false)
  const [progress, setProgress] = useState(0) // 0-100
  const audioRef = useRef<HTMLAudioElement | null>(null)

  const play = useCallback(async (audioUrl: string) => {
    try {
      // åœæ­¢å½“å‰æ’­æ”¾
      if (audioRef.current) {
        audioRef.current.pause()
        audioRef.current = null
      }

      // åˆ›å»ºæ–°çš„éŸ³é¢‘å¯¹è±¡
      const audio = new Audio(audioUrl)
      audioRef.current = audio

      // ç›‘å¬äº‹ä»¶
      audio.onplay = () => setIsPlaying(true)
      audio.onpause = () => setIsPlaying(false)
      audio.onended = () => {
        setIsPlaying(false)
        setProgress(0)
      }
      audio.ontimeupdate = () => {
        const percent = (audio.currentTime / audio.duration) * 100
        setProgress(percent)
      }

      // æ’­æ”¾
      await audio.play()
    } catch (error) {
      console.error('æ’­æ”¾å¤±è´¥:', error)
      throw error
    }
  }, [])

  const pause = useCallback(() => {
    audioRef.current?.pause()
  }, [])

  const stop = useCallback(() => {
    if (audioRef.current) {
      audioRef.current.pause()
      audioRef.current.currentTime = 0
      setProgress(0)
    }
  }, [])

  return {
    isPlaying,
    progress,
    play,
    pause,
    stop,
  }
}
```

---

## 5. æˆæœ¬åˆ†æ

### 5.1 æ¯æ¬¡å¯¹è¯æˆæœ¬

å‡è®¾åœºæ™¯ï¼š
- ç”¨æˆ·è¯­éŸ³è¾“å…¥ï¼šå¹³å‡ 10 ç§’
- AI æ–‡å­—å›å¤ï¼šå¹³å‡ 50 å­—

**STT æˆæœ¬**:
- Whisper: $0.006/åˆ†é’Ÿ Ã— (10ç§’/60) = $0.001

**AI å¯¹è¯æˆæœ¬**:
- Claude 3.5 Sonnet: ~$0.0075ï¼ˆè§ AI_ARCHITECTURE.mdï¼‰

**TTS æˆæœ¬**:
- OpenAI TTS: $15/1Må­—ç¬¦ Ã— 50å­— = $0.00075

**å•æ¬¡å¯¹è¯æ€»æˆæœ¬**: $0.001 + $0.0075 + $0.00075 = **$0.00925**

### 5.2 æœˆåº¦æˆæœ¬ä¼°ç®—

å‡è®¾æ¯å¤© 1000 æ´»è·ƒç”¨æˆ·ï¼Œæ¯äºº 10 æ¬¡å¯¹è¯ï¼š
- æ¯æ—¥å¯¹è¯æ¬¡æ•°: 10,000
- æ¯æ—¥æˆæœ¬: 10,000 Ã— $0.00925 = $92.5
- **æ¯æœˆæˆæœ¬: ~$2,775**

### 5.3 æˆæœ¬ä¼˜åŒ–ç­–ç•¥

1. **é™çº§æ–¹æ¡ˆ**: å½“ API ä¸å¯ç”¨æ—¶ä½¿ç”¨ Web Speech APIï¼ˆå…è´¹ï¼‰
2. **ç¼“å­˜ TTS**: å¸¸è§å›å¤ï¼ˆå¦‚"å¥½çš„"ã€"å·²è®°å½•"ï¼‰ç¼“å­˜éŸ³é¢‘
3. **æ‰¹é‡å¤„ç†**: å¤šä¸ªçŸ­æ¶ˆæ¯åˆå¹¶æˆä¸€æ¬¡ TTS è°ƒç”¨
4. **ç”¨æˆ·é™åˆ¶**: æ¯æ—¥è¯­éŸ³å¯¹è¯æ¬¡æ•°é™åˆ¶ï¼ˆå¦‚ 100 æ¬¡ï¼‰

---

## 6. é™çº§æ–¹æ¡ˆ

### 6.1 Web Speech API ä½œä¸ºå¤‡é€‰

```typescript
// lib/voice/fallback.ts

// STT é™çº§ï¼ˆæµè§ˆå™¨åŸç”Ÿï¼‰
export function useBrowserSTT() {
  const SpeechRecognition =
    window.SpeechRecognition || window.webkitSpeechRecognition

  if (!SpeechRecognition) {
    throw new Error('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«')
  }

  const recognition = new SpeechRecognition()
  recognition.lang = 'zh-CN'
  recognition.continuous = false
  recognition.interimResults = false

  return new Promise<string>((resolve, reject) => {
    recognition.onresult = (event) => {
      const transcript = event.results[0][0].transcript
      resolve(transcript)
    }
    recognition.onerror = reject
    recognition.start()
  })
}

// TTS é™çº§ï¼ˆæµè§ˆå™¨åŸç”Ÿï¼‰
export function useBrowserTTS(text: string) {
  if (!window.speechSynthesis) {
    throw new Error('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ')
  }

  const utterance = new SpeechSynthesisUtterance(text)
  utterance.lang = 'zh-CN'
  utterance.rate = 1.0
  utterance.pitch = 1.0

  window.speechSynthesis.speak(utterance)
}
```

### 6.2 æ™ºèƒ½é™çº§ç­–ç•¥

```typescript
// lib/voice/adaptive.ts

export async function transcribe(audioBlob: Blob): Promise<string> {
  try {
    // ä¼˜å…ˆä½¿ç”¨ Whisper API
    return await transcribeWithWhisper(audioBlob)
  } catch (error) {
    console.warn('Whisper API å¤±è´¥ï¼Œä½¿ç”¨æµè§ˆå™¨ STT', error)
    // é™çº§åˆ°æµè§ˆå™¨ STT
    return await useBrowserSTT()
  }
}

export async function synthesize(text: string): Promise<string> {
  try {
    // ä¼˜å…ˆä½¿ç”¨ OpenAI TTS
    return await synthesizeWithOpenAI(text)
  } catch (error) {
    console.warn('OpenAI TTS å¤±è´¥ï¼Œä½¿ç”¨æµè§ˆå™¨ TTS', error)
    // é™çº§åˆ°æµè§ˆå™¨ TTS
    useBrowserTTS(text)
    return '' // æµè§ˆå™¨ TTS æ— è¿”å›å€¼
  }
}
```

---

## 7. éšç§å’Œå®‰å…¨

### 7.1 éŸ³é¢‘æ•°æ®å¤„ç†

- âœ… å½•éŸ³æ•°æ®ä»…åœ¨ç”¨æˆ·æŒ‰ä¸‹æŒ‰é’®æ—¶é‡‡é›†
- âœ… éŸ³é¢‘æ–‡ä»¶ä¸Šä¼ åç«‹å³åˆ é™¤ï¼ˆä¸å­˜å‚¨ï¼‰
- âœ… Whisper API ä¸ä¼šä¿ç•™éŸ³é¢‘æ•°æ®ï¼ˆæ ¹æ® OpenAI æ”¿ç­–ï¼‰
- âœ… ç”¨æˆ·å¯ä»¥é€‰æ‹©å…³é—­è¯­éŸ³åŠŸèƒ½

### 7.2 ç”¨æˆ·æ§åˆ¶

```typescript
// ç”¨æˆ·åå¥½è®¾ç½®
interface VoicePreferences {
  voiceEnabled: boolean           // æ˜¯å¦å¯ç”¨è¯­éŸ³
  autoPlayAIResponse: boolean     // è‡ªåŠ¨æ’­æ”¾ AI å›å¤
  voiceGender: 'male' | 'female'  // å£°éŸ³åå¥½
  speechRate: number              // è¯­é€Ÿ 0.5-2.0
  showTranscript: boolean         // æ˜¾ç¤ºæ–‡å­—è½¬å½•
}
```

---

## 8. ä¸æ–‡æœ¬å¯¹è¯çš„å¯¹æ¯”

| åŠŸèƒ½ | è¯­éŸ³å¯¹è¯ | æ–‡æœ¬å¯¹è¯ |
|------|---------|---------|
| **è¾“å…¥é€Ÿåº¦** | å¿«ï¼ˆè‡ªç„¶è¯´è¯ï¼‰ | æ…¢ï¼ˆéœ€è¦æ‰“å­—ï¼‰ |
| **å…æ‰“å­—** | âœ… | âŒ |
| **é€‚åˆä¸“æ³¨åœºæ™¯** | âœ…ï¼ˆä¸æ‰“æ–­æµç¨‹ï¼‰ | âŒï¼ˆéœ€è¦é”®ç›˜ï¼‰ |
| **å‡†ç¡®æ€§** | ä¸­ï¼ˆå¯èƒ½è¯¯è¯†åˆ«ï¼‰ | é«˜ï¼ˆç²¾ç¡®è¾“å…¥ï¼‰ |
| **éšç§æ€§** | ä½ï¼ˆéœ€è¦éº¦å…‹é£ï¼‰ | é«˜ï¼ˆæ— éœ€æƒé™ï¼‰ |
| **ç¦»çº¿æ”¯æŒ** | æœ‰é™ï¼ˆé™çº§æ–¹æ¡ˆï¼‰ | å®Œå…¨æ”¯æŒ |
| **æˆæœ¬** | é«˜ï¼ˆAPI è°ƒç”¨ï¼‰ | ä½ï¼ˆä»… AI å¯¹è¯ï¼‰ |
| **å†å²è®°å½•** | æœ‰ï¼ˆä¿å­˜è½¬å½•ï¼‰ | æœ‰ï¼ˆå®Œæ•´æ–‡å­—ï¼‰ |

**ç»“è®º**: è¯­éŸ³ä¼˜å…ˆï¼Œä½†ä¿ç•™æ–‡å­—è¾“å…¥é€‰é¡¹ã€‚

---

## 9. å®æ–½ä¼˜å…ˆçº§

### Phase 1: åŸºç¡€è¯­éŸ³å¯¹è¯ï¼ˆ2 å‘¨ï¼‰
- [ ] å®ç°å½•éŸ³åŠŸèƒ½ï¼ˆMediaRecorderï¼‰
- [ ] é›†æˆ Whisper APIï¼ˆSTTï¼‰
- [ ] é›†æˆ OpenAI TTS API
- [ ] åŸºç¡€ UIï¼ˆæŒ‰ä½è¯´è¯æŒ‰é’®ï¼‰

### Phase 2: ä½“éªŒä¼˜åŒ–ï¼ˆ1 å‘¨ï¼‰
- [ ] æ³¢å½¢åŠ¨ç”»å¯è§†åŒ–
- [ ] æ’­æ”¾æ§åˆ¶ï¼ˆæš‚åœ/ç»§ç»­ï¼‰
- [ ] è‡ªåŠ¨åœé¡¿æ£€æµ‹
- [ ] é”™è¯¯å¤„ç†å’Œé‡è¯•

### Phase 3: é«˜çº§åŠŸèƒ½ï¼ˆ1 å‘¨ï¼‰
- [ ] è¯­éŸ³è®¾ç½®ï¼ˆå£°éŸ³é€‰æ‹©ã€è¯­é€Ÿï¼‰
- [ ] TTS éŸ³é¢‘ç¼“å­˜
- [ ] é™çº§æ–¹æ¡ˆï¼ˆWeb Speech APIï¼‰
- [ ] æ€§èƒ½ç›‘æ§

### Phase 4: æ–‡æœ¬æ”¯æŒï¼ˆå¯é€‰ï¼‰
- [ ] æ–‡å­—è¾“å…¥æ¡†ï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰
- [ ] è¯­éŸ³/æ–‡å­—åˆ‡æ¢å¼€å…³
- [ ] æ··åˆå¯¹è¯ï¼ˆéƒ¨åˆ†è¯­éŸ³ï¼Œéƒ¨åˆ†æ–‡å­—ï¼‰

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**åˆ›å»ºæ—¥æœŸ**: 2025-01-10
**æœ€åæ›´æ–°**: 2025-01-10
