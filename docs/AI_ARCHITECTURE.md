# UnoDay AI Architecture Design

## é¡¹ç›®æ¦‚è¿°

UnoDay å°†é›†æˆ AI å¯¹è¯èƒ½åŠ›ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªç„¶è¯­è¨€ä¸ AI äº¤äº’æ¥ï¼š
- åˆ›å»ºå’Œç®¡ç†æ‚å¿µï¼ˆdistractionsï¼‰
- æ§åˆ¶åº”ç”¨ UIï¼ˆå¯åŠ¨ä¸“æ³¨ã€å®Œæˆä»»åŠ¡ã€æ‰“å¼€æ‚å¿µç®±ç­‰ï¼‰
- è·å–ä»»åŠ¡å»ºè®®å’Œä¸“æ³¨æŒ‡å¯¼
- è¿›è¡Œè¯­ä¹‰æœç´¢å†å²ä»»åŠ¡

**æŠ€æœ¯æ ˆ**: Next.js 15 + Vercel AI SDK + Supabase (PostgreSQL + pgvector)

---

## 1. ç³»ç»Ÿæ¶æ„è®¾è®¡

### 1.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        User Interface                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Focus Mode   â”‚  â”‚ AI Chat      â”‚  â”‚ Distraction  â”‚      â”‚
â”‚  â”‚ Component    â”‚  â”‚ Interface    â”‚  â”‚ Drawer       â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                  â”‚                  â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                            â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend Layer (Next.js)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                React Server Components                 â”‚  â”‚
â”‚  â”‚  â€¢ AI Chat API Route (/api/chat)                      â”‚  â”‚
â”‚  â”‚  â€¢ Tool Execution Layer                                â”‚  â”‚
â”‚  â”‚  â€¢ Context Management                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                Client Components                       â”‚  â”‚
â”‚  â”‚  â€¢ useChat hook (Vercel AI SDK)                       â”‚  â”‚
â”‚  â”‚  â€¢ UI state management (React hooks)                   â”‚  â”‚
â”‚  â”‚  â€¢ Real-time updates (Supabase Realtime)              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AI Provider Layer                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            Anthropic Claude API (æ¨è)                 â”‚  â”‚
â”‚  â”‚  â€¢ Model: Claude 3.5 Sonnet                           â”‚  â”‚
â”‚  â”‚  â€¢ Function/Tool calling support                       â”‚  â”‚
â”‚  â”‚  â€¢ Streaming responses                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              OpenAI API (å¤‡é€‰)                         â”‚  â”‚
â”‚  â”‚  â€¢ Model: GPT-4 Turbo                                 â”‚  â”‚
â”‚  â”‚  â€¢ Function calling support                            â”‚  â”‚
â”‚  â”‚  â€¢ Embeddings API (text-embedding-3-small)            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Data Layer (Supabase)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              PostgreSQL + pgvector                     â”‚  â”‚
â”‚  â”‚  â€¢ thoughts è¡¨ (ä»»åŠ¡/æ‚å¿µ/ä¸“æ³¨è®°å½•)                     â”‚  â”‚
â”‚  â”‚  â€¢ conversations è¡¨ (AI å¯¹è¯å†å²)                      â”‚  â”‚
â”‚  â”‚  â€¢ messages è¡¨ (å¯¹è¯æ¶ˆæ¯)                               â”‚  â”‚
â”‚  â”‚  â€¢ user_preferences è¡¨ (ç”¨æˆ·åå¥½è®¾ç½®)                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    RPC Functions                       â”‚  â”‚
â”‚  â”‚  â€¢ switch_focus() - åˆ‡æ¢ä¸“æ³¨ä»»åŠ¡                       â”‚  â”‚
â”‚  â”‚  â€¢ pause_task() - æš‚åœä»»åŠ¡                             â”‚  â”‚
â”‚  â”‚  â€¢ match_thoughts() - è¯­ä¹‰æœç´¢                         â”‚  â”‚
â”‚  â”‚  â€¢ create_thought_with_embedding() - åˆ›å»ºå¸¦å‘é‡çš„æƒ³æ³•  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Supabase Realtime                         â”‚  â”‚
â”‚  â”‚  â€¢ ç›‘å¬ thoughts è¡¨å˜åŒ–                                â”‚  â”‚
â”‚  â”‚  â€¢ å®æ—¶åŒæ­¥ UI çŠ¶æ€                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ ¸å¿ƒæŠ€æœ¯é€‰å‹

| å±‚çº§ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **å‰ç«¯æ¡†æ¶** | Next.js 15 (App Router) | å·²æœ‰é¡¹ç›®åŸºç¡€ï¼Œæ”¯æŒ RSC å’Œ Server Actions |
| **AI SDK** | Vercel AI SDK 3.x | ç»Ÿä¸€çš„ AI æ¥å£ï¼Œæ”¯æŒæµå¼å“åº”å’Œå·¥å…·è°ƒç”¨ |
| **AI æ¨¡å‹** | Anthropic Claude 3.5 Sonnet | å¼ºå¤§çš„å·¥å…·è°ƒç”¨èƒ½åŠ›ï¼Œä¸­æ–‡æ”¯æŒå¥½ |
| **å‘é‡åµŒå…¥** | OpenAI text-embedding-3-small | é«˜æ€§ä»·æ¯”ï¼Œ768 ç»´åº¦ï¼Œ$0.02/1M tokens |
| **æ•°æ®åº“** | Supabase (PostgreSQL + pgvector) | å·²æœ‰åŸºç¡€è®¾æ–½ï¼ŒåŸç”Ÿæ”¯æŒå‘é‡æœç´¢ |
| **å®æ—¶é€šä¿¡** | Supabase Realtime | ç›‘å¬æ•°æ®åº“å˜åŒ–ï¼Œå®æ—¶æ›´æ–° UI |
| **è®¤è¯** | Supabase Auth | ç”¨æˆ·è®¤è¯å’Œ RLS æƒé™æ§åˆ¶ |

---

## 2. AI èŠå¤©ç•Œé¢è®¾è®¡

### 2.1 UI ä½ç½®æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåº¦ |
|------|------|------|--------|
| **æµ®åŠ¨æŒ‰é’® + æŠ½å±‰** | ä¸å¹²æ‰°ç°æœ‰ç•Œé¢ï¼›å…¨å±€å¯è®¿é—®ï¼›ç±»ä¼¼ ChatGPT ä½“éªŒ | éœ€è¦é¢å¤–ç‚¹å‡»æ‰“å¼€ | â­â­â­â­â­ |
| **ç‹¬ç«‹é¡µé¢** | ç©ºé—´å……è¶³ï¼›ä¸“æ³¨å¯¹è¯ä½“éªŒ | ç¦»å¼€å½“å‰ä»»åŠ¡ä¸Šä¸‹æ–‡ï¼›æ“ä½œå‰²è£‚ | â­â­ |
| **Focus Mode å†…åµŒ** | ä¸“æ³¨æ¨¡å¼ä¸‹å¯ç›´æ¥å¯¹è¯ | ä»…é™ Focus æ¨¡å¼ï¼›ç•Œé¢æ‹¥æŒ¤ | â­â­â­ |
| **é¡¶éƒ¨å›ºå®šæ ** | å§‹ç»ˆå¯è§ï¼›å¿«é€Ÿè®¿é—® | å ç”¨å±å¹•ç©ºé—´ï¼›å¹²æ‰°è§†è§‰ | â­â­ |

**æ¨èæ–¹æ¡ˆ**: æµ®åŠ¨æŒ‰é’® + ä¾§è¾¹æŠ½å±‰

### 2.2 UI è®¾è®¡ç»†èŠ‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UnoDay ä¸»ç•Œé¢                           â”‚
â”‚                                          â”‚
â”‚  [Hero Section]                          â”‚
â”‚  [Focus Mode]                            â”‚
â”‚  [Distraction Drawer]                   â”‚
â”‚                                          â”‚
â”‚                                          â”‚
â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                            â”‚   ğŸ’¬     â”‚ â”‚  â† æµ®åŠ¨æŒ‰é’®
â”‚                            â”‚  AIåŠ©æ‰‹  â”‚ â”‚     (å›ºå®šåœ¨å³ä¸‹è§’)
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‚¹å‡»åå±•å¼€ä¾§è¾¹æŠ½å±‰ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UnoDay ä¸»ç•Œé¢          â”‚  AI å¯¹è¯æŠ½å±‰   â”‚
â”‚                        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  [Hero Section]        â”‚ â”‚   AI åŠ©æ‰‹  â”‚ â”‚
â”‚  [Focus Mode]          â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚  [Distraction Drawer]  â”‚ â”‚            â”‚ â”‚
â”‚                        â”‚ â”‚ [å¯¹è¯è®°å½•] â”‚ â”‚
â”‚                        â”‚ â”‚            â”‚ â”‚
â”‚                        â”‚ â”‚            â”‚ â”‚
â”‚                        â”‚ â”‚ [è¾“å…¥æ¡†]   â”‚ â”‚
â”‚                        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”  â”‚                â”‚
â”‚              â”‚ å…³é—­ â”‚  â”‚                â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 ç»„ä»¶ç»“æ„

```
components/
â”œâ”€â”€ AIChat/
â”‚   â”œâ”€â”€ AIChatButton.tsx          # æµ®åŠ¨æŒ‰é’®
â”‚   â”œâ”€â”€ AIChatDrawer.tsx          # ä¾§è¾¹æŠ½å±‰å®¹å™¨
â”‚   â”œâ”€â”€ ChatMessageList.tsx       # æ¶ˆæ¯åˆ—è¡¨
â”‚   â”œâ”€â”€ ChatMessage.tsx           # å•æ¡æ¶ˆæ¯ï¼ˆç”¨æˆ·/AIï¼‰
â”‚   â”œâ”€â”€ ChatInput.tsx             # è¾“å…¥æ¡†
â”‚   â”œâ”€â”€ ToolExecutionIndicator.tsx # å·¥å…·è°ƒç”¨çŠ¶æ€æç¤º
â”‚   â””â”€â”€ SuggestedActions.tsx      # å¿«é€Ÿæ“ä½œå»ºè®®
```

---

## 3. Vercel AI SDK é›†æˆæ–¹æ¡ˆ

### 3.1 æ ¸å¿ƒ API è·¯ç”±è®¾è®¡

```typescript
// app/api/chat/route.ts
import { anthropic } from '@ai-sdk/anthropic'
import { streamText, tool } from 'ai'
import { z } from 'zod'

export async function POST(req: Request) {
  const { messages } = await req.json()

  const result = await streamText({
    model: anthropic('claude-3-5-sonnet-20241022'),
    messages,
    system: `ä½ æ˜¯ UnoDay çš„ AI åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·ä¸“æ³¨äºå½“å‰æœ€é‡è¦çš„ä¸€ä»¶äº‹ã€‚

å½“å‰æ—¶é—´: ${new Date().toISOString()}

ä½ çš„èƒ½åŠ›ï¼š
1. å¸®åŠ©ç”¨æˆ·åˆ›å»ºæ‚å¿µè®°å½•ï¼ˆå½“ä»–ä»¬æƒ³åˆ°å…¶ä»–äº‹æƒ…æ—¶ï¼‰
2. æ§åˆ¶ä¸“æ³¨æ¨¡å¼ï¼ˆå¼€å§‹ã€æš‚åœã€å®Œæˆï¼‰
3. æœç´¢å†å²ä»»åŠ¡
4. æä¾›ä¸“æ³¨å»ºè®®

ç”¨æˆ·ç•Œé¢çŠ¶æ€å°†é€šè¿‡æ¶ˆæ¯å†å²ä¼ é€’ç»™ä½ ã€‚`,

    tools: {
      // åˆ›å»ºæ‚å¿µ
      createDistraction: tool({
        description: 'åˆ›å»ºä¸€ä¸ªæ–°çš„æ‚å¿µè®°å½•ï¼Œå½“ç”¨æˆ·æåˆ°æƒ³åˆ°äº†å…¶ä»–äº‹æƒ…æ—¶ä½¿ç”¨',
        parameters: z.object({
          content: z.string().describe('æ‚å¿µå†…å®¹'),
        }),
        execute: async ({ content }) => {
          // å®ç°åœ¨åé¢çš„ç« èŠ‚
          return { success: true, id: 'xxx' }
        },
      }),

      // å¼€å§‹ä¸“æ³¨
      startFocus: tool({
        description: 'å¼€å§‹ä¸“æ³¨ä¸€ä¸ªæ–°ä»»åŠ¡',
        parameters: z.object({
          task: z.string().describe('è¦ä¸“æ³¨çš„ä»»åŠ¡å†…å®¹'),
        }),
        execute: async ({ task }) => {
          return { success: true, message: 'å·²è¿›å…¥ä¸“æ³¨æ¨¡å¼' }
        },
      }),

      // å®Œæˆä»»åŠ¡
      completeTask: tool({
        description: 'æ ‡è®°å½“å‰ä»»åŠ¡ä¸ºå·²å®Œæˆ',
        parameters: z.object({}),
        execute: async () => {
          return { success: true, message: 'ä»»åŠ¡å·²å®Œæˆï¼' }
        },
      }),

      // æ‰“å¼€æ‚å¿µç®±
      openDistractionDrawer: tool({
        description: 'æ‰“å¼€æ‚å¿µç®±æŠ½å±‰ï¼Œè®©ç”¨æˆ·æŸ¥çœ‹æ‰€æœ‰æ‚å¿µ',
        parameters: z.object({}),
        execute: async () => {
          return { success: true, action: 'openDrawer' }
        },
      }),

      // æœç´¢ç›¸å…³ä»»åŠ¡
      searchThoughts: tool({
        description: 'ä½¿ç”¨è¯­ä¹‰æœç´¢æŸ¥æ‰¾ç›¸å…³çš„å†å²ä»»åŠ¡å’Œæ‚å¿µ',
        parameters: z.object({
          query: z.string().describe('æœç´¢å…³é”®è¯æˆ–æè¿°'),
          limit: z.number().optional().describe('è¿”å›ç»“æœæ•°é‡ï¼Œé»˜è®¤5'),
        }),
        execute: async ({ query, limit = 5 }) => {
          // å®ç°è¯­ä¹‰æœç´¢
          return { results: [] }
        },
      }),
    },

    maxSteps: 5, // å…è®¸å¤šæ­¥å·¥å…·è°ƒç”¨
  })

  return result.toDataStreamResponse()
}
```

### 3.2 å®¢æˆ·ç«¯ Hook ä½¿ç”¨

```typescript
// components/AIChat/AIChatDrawer.tsx
'use client'

import { useChat } from 'ai/react'
import { useEffect } from 'react'

export function AIChatDrawer({ isOpen, onClose }: Props) {
  const { messages, input, handleInputChange, handleSubmit, isLoading } = useChat({
    api: '/api/chat',
    onToolCall: ({ toolCall }) => {
      // å¤„ç†å·¥å…·è°ƒç”¨çš„ UI åé¦ˆ
      console.log('AI æ­£åœ¨æ‰§è¡Œ:', toolCall.toolName)
    },
    onFinish: (message) => {
      // æ£€æŸ¥æ˜¯å¦æœ‰éœ€è¦åœ¨å®¢æˆ·ç«¯æ‰§è¡Œçš„æ“ä½œ
      const lastToolCall = message.toolInvocations?.findLast(
        (t) => t.toolName === 'openDistractionDrawer'
      )

      if (lastToolCall?.result?.action === 'openDrawer') {
        // è§¦å‘æ‰“å¼€æ‚å¿µç®±çš„äº‹ä»¶
        window.dispatchEvent(new CustomEvent('openDistractionDrawer'))
      }
    },
  })

  return (
    <div className={`ai-chat-drawer ${isOpen ? 'open' : ''}`}>
      <ChatMessageList messages={messages} />
      <ChatInput
        value={input}
        onChange={handleInputChange}
        onSubmit={handleSubmit}
        disabled={isLoading}
      />
    </div>
  )
}
```

---

## 4. AI å·¥å…·ï¼ˆToolsï¼‰å®šä¹‰

### 4.1 å·¥å…·åˆ†ç±»

| ç±»åˆ« | å·¥å…·åç§° | è¯´æ˜ | æ˜¯å¦ä¿®æ”¹æ•°æ® |
|------|----------|------|--------------|
| **æ•°æ®æ“ä½œ** | createDistraction | åˆ›å»ºæ‚å¿µ | âœ… |
| | updateDistraction | æ›´æ–°æ‚å¿µå†…å®¹ | âœ… |
| | deleteDistraction | åˆ é™¤æ‚å¿µ | âœ… |
| | createThought | åˆ›å»ºæƒ³æ³•/ä»»åŠ¡ | âœ… |
| **ä»»åŠ¡æ§åˆ¶** | startFocus | å¼€å§‹ä¸“æ³¨ | âœ… |
| | pauseTask | æš‚åœä»»åŠ¡ | âœ… |
| | completeTask | å®Œæˆä»»åŠ¡ | âœ… |
| | abandonTask | æ”¾å¼ƒä»»åŠ¡ | âœ… |
| **UI æ§åˆ¶** | openDistractionDrawer | æ‰“å¼€æ‚å¿µç®± | âŒ |
| | closeDistractionDrawer | å…³é—­æ‚å¿µç®± | âŒ |
| | exitFocusMode | é€€å‡ºä¸“æ³¨æ¨¡å¼ | âŒ |
| **ä¿¡æ¯æŸ¥è¯¢** | searchThoughts | è¯­ä¹‰æœç´¢ä»»åŠ¡ | âŒ |
| | getCurrentTask | è·å–å½“å‰ä»»åŠ¡ | âŒ |
| | getTodayStats | è·å–ä»Šæ—¥ç»Ÿè®¡ | âŒ |
| | getStreak | è·å–è¿ç»­å¤©æ•° | âŒ |

### 4.2 å·¥å…·å®ç°æ¨¡å¼

**æœåŠ¡ç«¯å·¥å…·**ï¼ˆç›´æ¥æ“ä½œæ•°æ®åº“ï¼‰ï¼š
```typescript
// app/api/chat/tools/createDistraction.ts
import { supabase } from '@/lib/supabase'
import { generateEmbedding } from '@/lib/embeddings'

export async function createDistraction({
  userId,
  content,
}: {
  userId: string
  content: string
}) {
  // 1. ç”Ÿæˆå‘é‡åµŒå…¥
  const embedding = await generateEmbedding(content)

  // 2. è°ƒç”¨ Supabase RPC
  const { data, error } = await supabase.rpc('create_thought_with_embedding', {
    p_user_id: userId,
    p_content: content,
    p_embedding: embedding,
    p_status: 'inbox',
  })

  if (error) throw error

  return {
    success: true,
    id: data.id,
    message: `å·²å°†"${content}"æ·»åŠ åˆ°æ‚å¿µç®±`,
  }
}
```

**å®¢æˆ·ç«¯å·¥å…·**ï¼ˆé€šè¿‡è¿”å›å€¼è§¦å‘ UI æ“ä½œï¼‰ï¼š
```typescript
// åœ¨ API è·¯ç”±ä¸­è¿”å›ç‰¹æ®Šæ ‡è¯†
openDistractionDrawer: tool({
  description: 'æ‰“å¼€æ‚å¿µç®±æŠ½å±‰',
  parameters: z.object({}),
  execute: async () => {
    return {
      success: true,
      action: 'UI_OPERATION',
      operation: 'openDrawer',
    }
  },
})

// å®¢æˆ·ç«¯ç›‘å¬å¹¶æ‰§è¡Œ
useEffect(() => {
  if (lastMessage?.toolInvocations) {
    lastMessage.toolInvocations.forEach((invocation) => {
      if (invocation.result?.action === 'UI_OPERATION') {
        executeUIOperation(invocation.result.operation)
      }
    })
  }
}, [lastMessage])
```

---

## 5. ä¸Šä¸‹æ–‡ç®¡ç†ç­–ç•¥

### 5.1 å¯¹è¯ä¸Šä¸‹æ–‡

AI éœ€è¦äº†è§£çš„ç”¨æˆ·çŠ¶æ€ï¼š
- å½“å‰æ˜¯å¦åœ¨ä¸“æ³¨æ¨¡å¼
- å½“å‰ä¸“æ³¨çš„ä»»åŠ¡ï¼ˆå¦‚æœæœ‰ï¼‰
- ä»Šæ—¥å·²å®Œæˆçš„ Uno æ•°é‡
- å½“å‰è¿ç»­å¤©æ•°ï¼ˆStreakï¼‰
- æ‚å¿µç®±ä¸­çš„æ‚å¿µæ•°é‡

**å®ç°æ–¹å¼**: åœ¨æ¯æ¬¡å¯¹è¯æ—¶ï¼Œå°†å…³é”®çŠ¶æ€ä½œä¸º System Message çš„ä¸€éƒ¨åˆ†æ³¨å…¥ï¼š

```typescript
const userContext = await getUserContext(userId)

const systemPrompt = `ä½ æ˜¯ UnoDay çš„ AI åŠ©æ‰‹ã€‚

å½“å‰ç”¨æˆ·çŠ¶æ€ï¼š
- ä¸“æ³¨æ¨¡å¼: ${userContext.isFocused ? 'å¼€å¯' : 'å…³é—­'}
${userContext.currentTask ? `- å½“å‰ä»»åŠ¡: "${userContext.currentTask}"` : ''}
- ä»Šæ—¥å®Œæˆ: ${userContext.todayCount}/${DAILY_UNO_LIMIT}
- è¿ç»­å¤©æ•°: ${userContext.streak} å¤©
- æ‚å¿µæ•°é‡: ${userContext.distractionCount} ä¸ª

åŸºäºä»¥ä¸ŠçŠ¶æ€ï¼Œæ™ºèƒ½åœ°å¸®åŠ©ç”¨æˆ·ã€‚`
```

### 5.2 å¯¹è¯å†å²å­˜å‚¨

```typescript
// ä¿å­˜å¯¹è¯åˆ°æ•°æ®åº“
async function saveConversation(userId: string, messages: Message[]) {
  await supabase.from('conversations').insert({
    user_id: userId,
    messages: messages, // JSONB ç±»å‹
    created_at: new Date().toISOString(),
  })
}
```

### 5.3 é•¿å¯¹è¯ä¼˜åŒ–

å½“å¯¹è¯è¿‡é•¿æ—¶ï¼ˆè¶…è¿‡ 20 æ¡æ¶ˆæ¯ï¼‰ï¼Œä½¿ç”¨æ»‘åŠ¨çª—å£ + æ‘˜è¦ï¼š
1. ä¿ç•™æœ€è¿‘ 10 æ¡æ¶ˆæ¯çš„å®Œæ•´å†…å®¹
2. å°†æ›´æ—©çš„æ¶ˆæ¯æ€»ç»“ä¸ºç®€çŸ­çš„ä¸Šä¸‹æ–‡
3. æ°¸è¿œä¿ç•™ç¬¬ä¸€æ¡æ¶ˆæ¯ï¼ˆåŒ…å«åˆå§‹ä¸Šä¸‹æ–‡ï¼‰

---

## 6. å®æ—¶é€šä¿¡æ–¹æ¡ˆ

### 6.1 Supabase Realtime é›†æˆ

```typescript
// hooks/useRealtimeThoughts.ts
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'

export function useRealtimeThoughts(userId: string) {
  const [thoughts, setThoughts] = useState<Thought[]>([])

  useEffect(() => {
    // è®¢é˜… thoughts è¡¨çš„å˜åŒ–
    const channel = supabase
      .channel('thoughts-changes')
      .on(
        'postgres_changes',
        {
          event: '*',
          schema: 'public',
          table: 'thoughts',
          filter: `user_id=eq.${userId}`,
        },
        (payload) => {
          if (payload.eventType === 'INSERT') {
            setThoughts((prev) => [...prev, payload.new as Thought])
          } else if (payload.eventType === 'UPDATE') {
            setThoughts((prev) =>
              prev.map((t) => (t.id === payload.new.id ? payload.new as Thought : t))
            )
          } else if (payload.eventType === 'DELETE') {
            setThoughts((prev) => prev.filter((t) => t.id !== payload.old.id))
          }
        }
      )
      .subscribe()

    return () => {
      supabase.removeChannel(channel)
    }
  }, [userId])

  return thoughts
}
```

### 6.2 AI æ“ä½œåé¦ˆæµç¨‹

```
User: "æŠŠ'å­¦ä¹  React'åŠ åˆ°æ‚å¿µç®±"
  â†“
AI Chat API æ¥æ”¶è¯·æ±‚
  â†“
AI å†³å®šè°ƒç”¨ createDistraction å·¥å…·
  â†“
å·¥å…·æ‰§è¡Œ: å†™å…¥ Supabase thoughts è¡¨
  â†“
Supabase Realtime è§¦å‘ INSERT äº‹ä»¶
  â†“
å®¢æˆ·ç«¯ useRealtimeThoughts æ¥æ”¶æ›´æ–°
  â†“
DistractionDrawer è‡ªåŠ¨åˆ·æ–°åˆ—è¡¨
  â†“
AI è¿”å›ç¡®è®¤æ¶ˆæ¯: "å·²æ·»åŠ åˆ°æ‚å¿µç®±"
```

---

## 7. å®‰å…¨æ€§è®¾è®¡

### 7.1 è®¤è¯å’Œæˆæƒ

- æ‰€æœ‰ API è·¯ç”±å¿…é¡»éªŒè¯ç”¨æˆ·èº«ä»½
- ä½¿ç”¨ Supabase Auth çš„ JWT token
- RLS ç­–ç•¥ç¡®ä¿ç”¨æˆ·åªèƒ½æ“ä½œè‡ªå·±çš„æ•°æ®

```typescript
// app/api/chat/route.ts
import { createServerComponentClient } from '@supabase/auth-helpers-nextjs'
import { cookies } from 'next/headers'

export async function POST(req: Request) {
  const supabase = createServerComponentClient({ cookies })

  const {
    data: { user },
  } = await supabase.auth.getUser()

  if (!user) {
    return new Response('Unauthorized', { status: 401 })
  }

  // ç»§ç»­å¤„ç†...
}
```

### 7.2 å·¥å…·è°ƒç”¨é™åˆ¶

- æ•æ„Ÿæ“ä½œï¼ˆåˆ é™¤ã€æ”¾å¼ƒä»»åŠ¡ï¼‰éœ€è¦äºŒæ¬¡ç¡®è®¤
- é¢‘ç‡é™åˆ¶ï¼šæ¯åˆ†é’Ÿæœ€å¤š 10 æ¬¡å·¥å…·è°ƒç”¨
- æ•°æ®éªŒè¯ï¼šæ‰€æœ‰è¾“å…¥å‚æ•°ä½¿ç”¨ Zod schema éªŒè¯

### 7.3 éšç§ä¿æŠ¤

- å¯¹è¯å†å²åŠ å¯†å­˜å‚¨
- æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ä»»åŠ¡å†…å®¹ï¼‰ä¸å‘é€åˆ°ç¬¬ä¸‰æ–¹åˆ†ææœåŠ¡
- ç”¨æˆ·å¯ä»¥åˆ é™¤æ‰€æœ‰å¯¹è¯å†å²

---

## 8. æ€§èƒ½ä¼˜åŒ–

### 8.1 æµå¼å“åº”

ä½¿ç”¨ Vercel AI SDK çš„æµå¼ APIï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼š
```typescript
const result = await streamText({ ... })
return result.toDataStreamResponse()
```

å‰ç«¯ä½¿ç”¨ `useChat` è‡ªåŠ¨å¤„ç†æµå¼æ›´æ–°ã€‚

### 8.2 å‘é‡æœç´¢ä¼˜åŒ–

```sql
-- ä¸º embedding åˆ—åˆ›å»ºç´¢å¼•
CREATE INDEX ON thoughts USING ivfflat (embedding vector_cosine_ops)
  WITH (lists = 100);
```

### 8.3 ç¼“å­˜ç­–ç•¥

- ç”¨æˆ·ä¸Šä¸‹æ–‡ç¼“å­˜ï¼ˆRedisï¼‰ï¼šé¿å…æ¯æ¬¡å¯¹è¯éƒ½æŸ¥è¯¢æ•°æ®åº“
- å‘é‡åµŒå…¥ç¼“å­˜ï¼šç›¸åŒæ–‡æœ¬ä¸é‡å¤ç”Ÿæˆ embedding
- AI å“åº”ç¼“å­˜ï¼šå¸¸è§é—®é¢˜ç¼“å­˜ç­”æ¡ˆï¼ˆå¯é€‰ï¼‰

---

## 9. é”™è¯¯å¤„ç†

### 9.1 AI è°ƒç”¨å¤±è´¥

```typescript
try {
  const result = await streamText({ ... })
  return result.toDataStreamResponse()
} catch (error) {
  console.error('AI è°ƒç”¨å¤±è´¥:', error)

  return new Response(
    JSON.stringify({
      error: 'æŠ±æ­‰ï¼ŒAI æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•',
    }),
    { status: 500 }
  )
}
```

### 9.2 å·¥å…·æ‰§è¡Œå¤±è´¥

å·¥å…·å†…éƒ¨æ•è·é”™è¯¯å¹¶è¿”å›å‹å¥½æ¶ˆæ¯ï¼š
```typescript
execute: async ({ content }) => {
  try {
    const result = await createDistraction(userId, content)
    return { success: true, ...result }
  } catch (error) {
    return {
      success: false,
      error: 'åˆ›å»ºæ‚å¿µå¤±è´¥ï¼Œè¯·é‡è¯•',
      details: error.message
    }
  }
}
```

### 9.3 ç½‘ç»œå¼‚å¸¸å¤„ç†

å®¢æˆ·ç«¯ä½¿ç”¨ `useChat` çš„ `onError` å¤„ç†ï¼š
```typescript
const { messages, ... } = useChat({
  api: '/api/chat',
  onError: (error) => {
    toast.error('å‘é€æ¶ˆæ¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥')
  },
})
```

---

## 10. æµ‹è¯•ç­–ç•¥

### 10.1 å•å…ƒæµ‹è¯•

- å·¥å…·å‡½æ•°çš„å•å…ƒæµ‹è¯•ï¼ˆcreateDistractionã€searchThoughts ç­‰ï¼‰
- ä¸Šä¸‹æ–‡ç®¡ç†å‡½æ•°æµ‹è¯•
- Supabase RPC è°ƒç”¨æµ‹è¯•ï¼ˆä½¿ç”¨ Supabase æœ¬åœ°å¼€å‘ç¯å¢ƒï¼‰

### 10.2 é›†æˆæµ‹è¯•

- AI API è·¯ç”±ç«¯åˆ°ç«¯æµ‹è¯•
- å·¥å…·è°ƒç”¨æµç¨‹æµ‹è¯•
- Realtime è®¢é˜…æµ‹è¯•

### 10.3 E2E æµ‹è¯•

ä½¿ç”¨ Playwright æµ‹è¯•å®Œæ•´ç”¨æˆ·æµç¨‹ï¼š
1. ç”¨æˆ·æ‰“å¼€ AI èŠå¤©
2. ç”¨æˆ·è¯´"æŠŠå­¦ä¹  React åŠ åˆ°æ‚å¿µç®±"
3. éªŒè¯æ‚å¿µç®±å‡ºç°æ–°æ¡ç›®
4. éªŒè¯ AI è¿”å›ç¡®è®¤æ¶ˆæ¯

---

## 11. ç›‘æ§å’Œæ—¥å¿—

### 11.1 å…³é”®æŒ‡æ ‡

- AI API è°ƒç”¨æ¬¡æ•°å’ŒæˆåŠŸç‡
- å¹³å‡å“åº”æ—¶é—´
- å·¥å…·è°ƒç”¨ç»Ÿè®¡ï¼ˆå“ªäº›å·¥å…·æœ€å¸¸ç”¨ï¼‰
- é”™è¯¯ç‡å’Œç±»å‹åˆ†å¸ƒ

### 11.2 æ—¥å¿—è®°å½•

```typescript
// lib/logger.ts
export function logAIInteraction({
  userId,
  prompt,
  response,
  toolCalls,
  duration,
  error,
}: LogData) {
  // å‘é€åˆ°æ—¥å¿—æœåŠ¡ï¼ˆå¦‚ Vercel Analyticsã€Sentryï¼‰
  console.log('[AI]', {
    userId,
    promptLength: prompt.length,
    responseLength: response?.length,
    toolCallCount: toolCalls?.length,
    duration,
    error: error?.message,
  })
}
```

---

## 12. æˆæœ¬ä¼°ç®—

### 12.1 AI API æˆæœ¬

**Anthropic Claude 3.5 Sonnet**:
- Input: $3 / 1M tokens
- Output: $15 / 1M tokens

å‡è®¾å¹³å‡æ¯æ¬¡å¯¹è¯ï¼š
- è¾“å…¥ï¼š1000 tokensï¼ˆç³»ç»Ÿæç¤º + å†å² + ç”¨æˆ·æ¶ˆæ¯ï¼‰
- è¾“å‡ºï¼š300 tokens
- æˆæœ¬ = (1000 Ã— $3 + 300 Ã— $15) / 1M = $0.0075

å¦‚æœæ¯å¤© 1000 ä¸ªç”¨æˆ·ï¼Œæ¯äºº 10 æ¬¡å¯¹è¯ï¼š
- æ¯æ—¥æˆæœ¬: 1000 Ã— 10 Ã— $0.0075 = $75
- æ¯æœˆæˆæœ¬: ~$2250

### 12.2 å‘é‡åµŒå…¥æˆæœ¬

**OpenAI text-embedding-3-small**:
- $0.02 / 1M tokens

å‡è®¾å¹³å‡æ¯æ¡æ‚å¿µ 50 tokensï¼š
- æ¯å¤© 1000 ç”¨æˆ·ï¼Œæ¯äºº 5 æ¡æ‚å¿µ = 5000 æ¡
- æˆæœ¬ = 5000 Ã— 50 Ã— $0.02 / 1M = $0.005
- æ¯æœˆæˆæœ¬: ~$0.15ï¼ˆå¯å¿½ç•¥ï¼‰

### 12.3 Supabase æˆæœ¬

- Free tier: 500MB æ•°æ®åº“ï¼Œæ— é™ API è¯·æ±‚
- Pro tier ($25/æœˆ): 8GB æ•°æ®åº“ï¼Œæ›´å¥½çš„æ€§èƒ½
- å‘é‡æœç´¢åœ¨ Pro tier ä»¥ä¸Šå¯ç”¨

---

## 13. æ¸è¿›å¼å®æ–½è®¡åˆ’

### Phase 1: åŸºç¡€å¯¹è¯èƒ½åŠ›ï¼ˆ1-2 å‘¨ï¼‰
- [ ] é›†æˆ Vercel AI SDK
- [ ] åˆ›å»º AI èŠå¤© UIï¼ˆæµ®åŠ¨æŒ‰é’® + æŠ½å±‰ï¼‰
- [ ] å®ç°åŸºç¡€å¯¹è¯ï¼ˆæ— å·¥å…·è°ƒç”¨ï¼‰
- [ ] è®¾ç½® Anthropic API

### Phase 2: æ•°æ®æ“ä½œå·¥å…·ï¼ˆ1 å‘¨ï¼‰
- [ ] å®ç° createDistraction å·¥å…·
- [ ] å®ç° updateDistraction å·¥å…·
- [ ] å®ç° deleteDistraction å·¥å…·
- [ ] æ·»åŠ å‘é‡åµŒå…¥ç”Ÿæˆ

### Phase 3: ä»»åŠ¡æ§åˆ¶å·¥å…·ï¼ˆ1 å‘¨ï¼‰
- [ ] å®ç° startFocus å·¥å…·
- [ ] å®ç° completeTask å·¥å…·
- [ ] å®ç° pauseTask å·¥å…·
- [ ] é›†æˆç°æœ‰ Focus Mode ç»„ä»¶

### Phase 4: UI æ§åˆ¶å’Œæœç´¢ï¼ˆ1 å‘¨ï¼‰
- [ ] å®ç° openDistractionDrawer ç­‰ UI å·¥å…·
- [ ] å®ç° searchThoughts è¯­ä¹‰æœç´¢
- [ ] ä¼˜åŒ–å·¥å…·è°ƒç”¨åé¦ˆ

### Phase 5: ä¼˜åŒ–å’Œç›‘æ§ï¼ˆ1 å‘¨ï¼‰
- [ ] æ·»åŠ  Realtime è®¢é˜…
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆç¼“å­˜ã€ç´¢å¼•ï¼‰
- [ ] æ·»åŠ ç›‘æ§å’Œæ—¥å¿—
- [ ] ç¼–å†™æµ‹è¯•

æ€»è®¡: 5-6 å‘¨å¼€å‘å‘¨æœŸ

---

## ä¸‹ä¸€æ­¥

1. âœ… å®Œæˆ AI æ¶æ„è®¾è®¡æ–‡æ¡£
2. â­ï¸ è®¾è®¡/è¯„ä¼°æ•°æ®åº“æ¶æ„ï¼ˆDATABASE_REDESIGN.mdï¼‰
3. â­ï¸ åˆ›å»º AI é›†æˆå®æ–½æŒ‡å—ï¼ˆAI_INTEGRATION_GUIDE.mdï¼‰
4. â­ï¸ åˆ›å»ºå®æ–½è·¯çº¿å›¾ï¼ˆIMPLEMENTATION_ROADMAP.mdï¼‰
5. â­ï¸ æ›´æ–° TypeScript ç±»å‹å®šä¹‰

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**åˆ›å»ºæ—¥æœŸ**: 2025-01-10
**æœ€åæ›´æ–°**: 2025-01-10
